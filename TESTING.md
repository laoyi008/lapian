# 测试说明

## 修复内容

### 问题
进度条卡在30%，无法继续分析

### 修复措施
1. ✅ 添加了详细的控制台日志
2. ✅ 增强了错误处理和提示
3. ✅ 优化了进度显示逻辑
4. ✅ 添加了HTTP错误检查

## 如何测试

### 准备工作
1. 打开浏览器开发者工具（按F12）
2. 切换到Console（控制台）标签页
3. 准备一个测试视频（建议10-30秒）

### 测试步骤

#### 测试1：正常流程
1. 上传视频
2. 点击"开始分析"
3. 观察进度条和控制台日志
4. **预期结果：**
   - 进度条从0%平滑增长到100%
   - 控制台显示详细的处理日志
   - 最终显示分析结果

#### 测试2：查看详细日志
在控制台中应该看到以下日志序列：

```
正在提取视频关键帧...
开始分析 8 个镜头
正在分析第 1/8 个镜头，时间戳: 0秒
提交第 1 个镜头的图像分析请求...
提交图像分析请求...
图像分析响应: {...}
第 1 个镜头提交成功，任务ID: xxx
等待第 1 个镜头的分析结果...
开始轮询任务结果，任务ID: xxx
轮询尝试 1/30
任务状态码: 1
任务处理中，等待 2000ms 后重试...
轮询尝试 2/30
任务状态码: 0
任务完成，返回结果
第 1 个镜头分析完成
进度更新: 36.2%
正在分析第 2/8 个镜头，时间戳: X秒
...
```

#### 测试3：错误处理
如果某个镜头分析失败，应该：
1. 在控制台显示详细错误信息
2. 在界面显示错误提示
3. 继续分析下一个镜头（不会卡住）

### 关键检查点

#### ✅ 进度条正常推进
- [ ] 0-10%: 提取关键帧
- [ ] 10-30%: 音频分析
- [ ] 30-80%: 画面分析
- [ ] 80-100%: 生成总结

#### ✅ 控制台日志完整
- [ ] 看到"开始分析 X 个镜头"
- [ ] 每个镜头都有"提交"、"成功"、"完成"日志
- [ ] 进度更新日志显示正确的百分比

#### ✅ 错误处理正确
- [ ] 如果出错，显示具体错误信息
- [ ] 不会因为单个镜头失败而卡住
- [ ] 最终能完成分析或给出明确的失败原因

### 常见测试场景

#### 场景1：有音频的视频
- 应该识别出语音内容
- 语音内容整合到画面描述中

#### 场景2：无音频的视频
- 不影响画面分析
- 只显示画面分析结果

#### 场景3：长视频（>60秒）
- 音频只分析前60秒
- 画面分析所有关键帧

#### 场景4：短视频（<10秒）
- 完整分析
- 可能提取较少的关键帧

### 性能指标

**预期处理时间：**
- 10秒视频：约1-2分钟
- 30秒视频：约2-4分钟
- 60秒视频：约4-8分钟

**注意：** 实际时间取决于：
- 网络速度
- API响应时间
- 视频复杂度

### 如果测试失败

#### 卡在30%
1. 查看控制台是否有错误
2. 检查是否看到"开始分析 X 个镜头"
3. 检查是否有API调用失败的日志
4. 参考 DEBUG_GUIDE.md 进行详细排查

#### 进度条不动
1. 检查网络连接
2. 查看控制台是否有错误
3. 尝试刷新页面重新上传

#### 显示错误信息
1. 记录完整的错误信息
2. 检查视频格式是否支持
3. 尝试其他视频

## 测试报告模板

```
测试时间：____年__月__日 __:__
测试视频：时长__秒，格式____，大小____MB
测试结果：□ 成功  □ 失败

进度情况：
- 0-10%: □ 正常  □ 异常
- 10-30%: □ 正常  □ 异常
- 30-80%: □ 正常  □ 异常
- 80-100%: □ 正常  □ 异常

控制台日志：
□ 完整  □ 不完整  □ 有错误

错误信息（如有）：
_________________________________

备注：
_________________________________
```

## 下一步

测试通过后，可以：
1. 尝试不同类型的视频
2. 测试边界情况（极短/极长视频）
3. 验证生成的AI提示词质量
4. 测试导出和复制功能
